<!DOCTYPE html>
<html lang=en>

<head>
    <link href=favicon.ico rel="shortcut icon" type=image/x-icon>
    <meta charset=utf-8>
    <meta content="IE=edge" http-equiv=X-UA-Compatible>
    <meta content="width=device-width, initial-scale=1" name=viewport>
    <link href=styles-9ee3c4491d35b3c1d830fa9da31c7861.css rel=stylesheet>
    <title>Configuration</title>
</head>

<body>
    <div class=container>
        <div class="row text-center p-3">
            <h1>ESP32 NAT Router Config <button class="btn btn-light float-end" data-bs-target=#information
                    data-bs-toggle=modal title=About type=button>?</button></h1>
        </div>
        <form action=apply method=POST> <input name=func type=hidden value=config>
            <h2>AP Settings (the new network)</h2> <span class=text-info><span id=clients>%d</span> client(s)
                connected</span>
            <div class="form-group row"> <label class=col-3 for=ap_ssid>SSID</label>
                <div class=col-9> <input class=form-control id=ap_ssid maxlength=32 name=ap_ssid
                        placeholder="SSID of the new network" type=text value=%s> </div>
            </div>
            <div class="form-group row mt-2"> <label class=col-3 for=ap_password>Password</label>
                <div class=col-9>
                    <div class=input-group> <input class="form-control col-9" id=ap_password maxlength=64
                            name=ap_password placeholder="Password of the new network" type=password value=%s> <span
                            class="input-group-text password" style="cursor: pointer;" title="show password">☀</span>
                    </div>
                </div>
            </div>
            <div class="form-group row col-9 offset-3"> <small class="form-text text-muted">Password less than 8 chars =
                    open</small> </div>
            <h2 class=mt-2>STA Settings (uplink WiFi network)</h2> <span class=text-%s id=sta><span id=symbol>%s</span>
                (signal strength: <span id=db>%s</span> db)</span>
            <div class="form-group row"> <label class=col-3 for=ssid>SSID</label>
                <div class=col-9> <input class=form-control id=ssid maxlength=32 name=ssid
                        placeholder="SSID of the existing network" type=text value=%s> </div>
            </div>
            <div class="form-group row mt-2"> <label class=col-3 for=password>Password</label>
                <div class=col-9>
                    <div class=input-group> <input class=form-control id=password maxlength=64 name=password
                            placeholder="Password of the existing network" type=password value=%s> <span
                            class="input-group-text password" style="cursor: pointer;" title="show password">☀</span>
                    </div>
                </div> <input class=form-control name=x type=hidden value=x>
            </div>
            <div class="form-group row col-4 offset-4 mt-4"> <input class="btn btn-primary" type=submit
                    value="Apply changes"> </div>
        </form>
        <h2 class=mt-2>Device Management</h2>
        <form action=scan method=GET>
            <div class="form-group row col-4 offset-4 mt-2"> <input class="btn btn-light" type=submit value="Wifi Scan">
            </div>
        </form>
        <form action=apply method=POST>
            <div class="form-group row col-4 offset-4 mt-2"> <input name=func type=hidden value=reboot> <input
                    class="btn btn-light" type=submit value=reboot> </div>
        </form>
        <form action=lock method=GET>
            <div class="form-group row col-4 offset-4 mt-2"> <input class="btn btn-light" type=submit
                    value="Lock Interface"> </div>
        </form>
        <form action=unlock method=GET style="display: %s;">
            <div class="form-group row col-4 offset-4 mt-2"> <input class="btn btn-light" type=submit
                    value="Relock Interface"> </div>
        </form>
        <form action=advanced method=GET>
            <div class="form-group row col-4 offset-4 mt-5"> <input class="btn btn-warning" type=submit value=Advanced>
            </div>
        </form>
    </div>
    <div aria-hidden=true class="modal fade" id=information tabindex=-1>
        <div class=modal-dialog>
            <div class=modal-content>
                <div class=modal-header>
                    <h5 class=modal-title>About</h5> <button aria-label=Close class=btn-close data-bs-dismiss=modal
                        type=button></button>
                </div>
                <div class=modal-body>
                    <table class="table table-striped">
                        <tbody>
                            <tr>
                                <td colspan=2>ESP32 NAT Router is a simple micro controller based range extender. This
                                    can also be used to open a second (guest) Wifi. <p>This is a spare time project. If
                                        you have any questions or issues, feel free to ask at the Github project page.
                                    </p>
                                </td>
                            </tr>
                            <tr>
                                <td>Version</td>
                                <td id=version>2.1.0</td>
                            </tr>
                            <tr>
                                <td>Hash</td>
                                <td id=hash>5cdc2c9</td>
                            </tr>
                            <tr>
                                <td>Release date</td>
                                <td id=date>25.03.2022</td>
                            </tr>
                            <tr>
                                <td class=text-center colspan=2><a class="btn btn-link"
                                        href=https://github.com/dchristl/esp32_nat_router_extended target=_blank>Project
                                        page at GitHub</a></td>
                            </tr>
                            <tr>
                                <td class=text-center colspan=2><a class="btn btn-link"
                                        href=https://www.buymeacoffee.com/dchristl target=_blank>Support my work, just
                                        buy me coffee</a> </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
                <div class=modal-footer> <button class="btn btn-light" data-bs-dismiss=modal type=button>Close</button>
                </div>
            </div>
        </div>
    </div>
    <script src=jquery.js></script>
    <script src=bootstrap.js></script>
    <script>
        $('.password').on('mousedown mouseup mouseout touchstart touchend', function mouseState(e) {
            var field = $(this).parent().find('input');
            if (e.type == "mousedown" || e.type == "touchstart") {
                field.get(0).type = 'text';
            } else {
                field.get(0).type = 'password';
            }
        });
    </script>
    <script>
        (function poll() {
            $.ajax({
                url: "/api",
                type: "GET",
                success: function (data) {
                    console.log(data);
                    $('#clients').text(data.clients);
                    $('#db').text(data.strength);
                    $('#sta').removeClass();
                    $('#sta').addClass('text-' + data.text);
                    $('#symbol').html(data.symbol);
                },
                dataType: "json",
                complete: setTimeout(function () {
                    poll();
                }, 3000),
                timeout: 3000
            })
        })();
    </script>
</body>

</html>